{"version":3,"sources":["utils/getWeb3.js","assets/key.png","components/WithdrawPage.js","utils/AltBn128.js","utils/helper.js","components/Web3StatusModal.js","components/404NotFound.js","components/FAQPage.js","components/DepositPage.js","components/StatusPage.js","App.js","serviceWorker.js","index.js"],"names":["Web3","require","resolveWeb3","resolve","options","isBrowser","provider","customProvider","window","ethereum","requestPermission","enable","web3","currentProvider","fallbackProvider","module","exports","arguments","length","undefined","Promise","isReactNative","navigator","product","document","readyState","addEventListener","bnZero","BN","WITHDRAWALSTATES","WithdrawPage","props","ws","dappGateway","_useState","useState","deposited","withdrawn","_useState2","Object","_home_kendrick_Development_Ethereum_heiswap_dapp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__","ringParticipants","setRingParticipants","_useState3","_useState4","unknownErrorStr","setUnknownErrorStr","_useState5","_useState6","txReceipt","setTxReceipt","_useState7","_useState8","forceCloseBlocksLeft","setForceCloseBlocksLeft","_useState9","_useState10","heiToken","setHeiToken","_useState11","_useState12","useRelayer","_useState13","_useState14","openModal","setOpenModal","_useState15","_useState16","withdrawalState","setWithdrawalState","noWeb3","noContractInstance","react__WEBPACK_IMPORTED_MODULE_6___default","a","createElement","style","width","rimble_ui__WEBPACK_IMPORTED_MODULE_7__","onSubmit","e","_home_kendrick_Development_Ethereum_heiswap_dapp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__","_home_kendrick_Development_Ethereum_heiswap_dapp_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default","mark","_callee2","ethAddress","heiswapInstance","_heiToken$split$slice3","_heiToken$split$slice4","ethAmount","ringIdx","randomSk","ringHash","ringHashBuf","ethAddressBuf","msgBuf","blocksLeftStr","blocksLeft","curParticipants","publicKeys","publicKeysBN","stealthSk","stealthPk","secretIdx","canSign","i","curPubKey","signature","dataBytecode","gas","tx","txR","excStr","wrap","_context2","prev","next","preventDefault","split","abrupt","slice","methods","getRingHash","call","sent","Buffer","from","concat","getForceCloseBlocksLeft","parseInt","getParticipants","getPublicKeys","map","x","filter","cmp","h1","serialize","bn128","ecMulG","ringSign","withdraw","append0x","toString","encodeABI","eth","estimateGas","to","_address","data","t0","t1","t2","t3","getTransactionCount","t4","nonce","sendTransaction","t5","indexOf","stop","Field","label","Input","type","placeholder","required","value","onChange","target","disabled","isOpen","maxWidth","p","Text","icononly","icon","color","position","top","right","mt","mr","onClick","mb","margin","size","textAlign","_callee","_heiToken$split$slice","_heiToken$split$slice2","_context","forceCloseRing","href","transactionHash","EC","crypto","soliditySha3","padLeft","P","N","A","G","bnOne","bnTwo","bnThree","curve","short","b","n","gRed","g","groupReduction","red","randomScalar","randomBytes","toRed","randomPoint","recurse","y2","redSqr","redMul","redIAdd","y","redSqrt","redSub","evalCurve","beta","mul","mod","add","powmod","scalarToPoint","_x","yP","_bn128$evalCurve","_bn128$evalCurve2","_home_kendrick_Development_Ethereum_heiswap_dapp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__","ecAdd","point1","point2","p1","point","p2","fp","getX","getY","ecMul","s","message","secretKey","secretKeyIdx","z1","z2","keyCount","c","Array","fill","h","h2","yTilde","u","idx","_idx","forEach","sci","sub","ringVerify","_signature","c0","clone","shiftedK","f","k","Math","log","repeat","and","hexStr","arr","isArray","reduce","acc","isBuffer","__webpack_require__","d","__webpack_exports__","StatusModal","setIsOpen","react_default","index_es","children","px","py","borderTop","borderColor","justifyContent","Outline","NotFoundPage","m","FAQPage","DepositPage","targetEthAmount","targetEthAddress","validEthAddress","slicedToArray","depForumParams","setDepForumParams","acknowledgeClose","txHash","heiTokenEst","heiTokenFinal","modalParams","setModalParams","asyncToGenerator","regenerator_default","estRingIdx","gasPrice","depositResult","depositEventRetVal","realRingIdx","getCurrentRingIdx","assign","getGasPrice","deposit","send","utils","toWei","gasLimit","events","Deposited","returnValues","validated","parentNode","classList","remove","items","checked","StatusPage","invalidToken","maxParticipants","depositedParticipants","withdrawnParticipants","participants","blocksLeftForForceClose","getRingMaxParticipants","HeiSwapApp","drizzleUtils","attempted","heiswapEvent$","setDappGateway","web3StatusModal","setweb3StatusModal","index","curTab","setCurTab","initDappGateway","_ref","accounts","getWeb3","createDrizzleUtils","getAccounts","getContractInstance","artifact","heiswapArtifact","createEvent$","currentAccount$","subscribe","apply","this","useEffect","minHeight","paddingBottom","marginTop","_callee3","_context3","opts","seed","alt","src","Logo","height","marginRight","float","borderBottom","variant","components_DepositPage","components_StatusPage","Web3StatusModal","h3","bottom","paddingTop","App","react_router_dom","react_router","exact","path","component","Boolean","location","hostname","match","ReactDOM","render","src_App","getElementById","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.2038eba2.chunk.js","sourcesContent":["// Extending https://github.com/trufflesuite/drizzle-utils/blob/master/packages/get-web3/index.js\n\nconst Web3 = require('web3')\n\nconst resolveWeb3 = (resolve, options, isBrowser) => {\n  let provider\n\n  if (options.customProvider) {\n    // use custom provider from options object\n    provider = options.customProvider\n  } else if (isBrowser && window.ethereum) {\n    // use `ethereum` object injected by MetaMask\n    provider = window.ethereum\n    if (options.requestPermission) window.ethereum.enable()\n  } else if (isBrowser && typeof window.web3 !== 'undefined') {\n    // use injected web3 object by legacy dapp browsers\n    provider = window.web3.currentProvider\n  } else if (options.fallbackProvider) {\n    // use fallback provider from options object\n    provider = options.fallbackProvider\n  }\n\n  const web3 = new Web3(provider)\n  resolve(web3)\n}\n\nconst getWeb3 = (options = {}) =>\n  new Promise(resolve => {\n    // handle server-side and React Native environments\n    const isReactNative =\n      typeof navigator !== 'undefined' && navigator.product === 'ReactNative'\n    const isNode = typeof window === 'undefined'\n    if (isNode || isReactNative) {\n      return resolveWeb3(resolve, options, false)\n    }\n\n    // if page is ready, resolve for web3 immediately\n    if (document.readyState === `complete`) {\n      return resolveWeb3(resolve, options, true)\n    }\n\n    // otherwise, resolve for web3 when page is done loading\n    return window.addEventListener('load', () =>\n      resolveWeb3(resolve, options, true)\n    )\n  })\n\nmodule.exports = getWeb3\n","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAQAAAAAYLlVAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QAAKqNIzIAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAAHdElNRQfjBhsJMSCmvvpHAAADz0lEQVRo3u2XTWhUVxTHf5lpazSOWpGZJCYlbfyCRCH4hSghhEKhCFK02aXVblotuKih4lL82ERKd3ahhRZU1IiWttr6kW4Kmhi1o6XBRBpFYjOx1OkoJjMm81y84/O9d2f6MnfmJV3MvYt75/7PPf//PffjvCmhECXAOlpYxWICJOmnm6N0CVZNK40so5Qy7nCL03zP04KwWqWJaxhK7WY1Eb5lXEGG2corhSIvYQ/pDPQGBuM8zoIYXGRuYQQctjlNcosLRBlV6NLcoZMrxG1jfxRCwk7L3QCbKZPREJu5ayEj7KFakADNXLJFIc+NWEhKXJ1khgMJctOiSbHQNW87Y4JtzU/AcXHzI0EXssWxASeUmdsFibmE51TmksTAIE5YwS4LwTMMDMaYp1i82IgWfQGt4uKAgkTk6g3wldh8qNi8LcixgLaAemm/U5DlmF5PclxGVio2nSQAWKovoEbaXgWplLafPulVKDZpbpte9AUY0iYV5MXBesIT14i9mPPS+gIS0lYpyF/SVlv3P5ZhvjnvX/2nICptE71AKc00M595/MOrFjIivXq+IcIog/TwAw+BN2ULozlxOsoyOcfXmc3ejK/+GH0ZM0QHi9gvvz7XFwA94iSRNeVkqylG5J2ozEfA+zkTu+vX+dADnHck2I3UEuIt3uMnB81tPqWOWVTSxEF5Hc3IhckrHwUpt/1azQOqiBGhgTUOu1rWE+I+M1nEuzbGMmoYzmf92/Legiv50JfYcn6uNWrNXaEvYIUnTdx1Fsyr+SsfEOAj+f2F/hl4x9Oig7NidYYjVPCYGD08FOwgrwEr9QVUeVpErXdulA4XlqCfOmCJfi4Ie1oMW2c80+fnIwCm6wsY87SIEJHe3xnQOQCk9LdgwNOigSHpDSpYiMUA9OkLCHpabOQN6V1SsBbJmV2eXrKUthxufZxprtll3BNsrf/0BruV2J0S5Col/tMnmOWYXcE5QdI0+k9vYHCDbdTxOmGa+NL29bB7cuiz1UM64c+NPur4XrDXJDv8Xv2ffEIQ2ES3CxnlGLUvnU48DG20/yfeTpwFhIjxgHPcsCH1NNLAbMa5x03OEtdZ/WceK96l47RIX6Qv0hfpi/T/S3qvjJdi/VSu3szlG6aS3kcJE6X3SUIu9D5ImPjHVif3pXdX+bsxCav/menUMIDBEHVTQw9QQ1fh6KF9wvSlhSN1ln05rN6nkjkKQ1bvN/9Wnz0Kuwjzu/TTfOy3ALcEM+VMsoSXG9FmjZXTK2ODzJysKDgTrhmFAt57ryi0KWPl/MISvwifAzVDed0VaYEiAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE5LTA2LTI3VDA3OjQ5OjMyKzAyOjAw4q3+/wAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOS0wNi0yN1QwNzo0OTozMiswMjowMJPwRkMAAAAZdEVYdFNvZnR3YXJlAHd3dy5pbmtzY2FwZS5vcmeb7jwaAAAAAElFTkSuQmCC\"","// @flow\nimport BN from 'bn.js'\nimport { Scalar, Point, serialize, h1, bn128 } from '../utils/AltBn128'\nimport { append0x } from '../utils/helper'\nimport React, { useState } from 'react'\nimport { Form, Modal, Card, Box, Button, Loader, Text } from 'rimble-ui'\nimport { DappGateway } from '../types/DappGateway'\n\n// BigNumber 0\nconst bnZero = new BN('0', 10)\n\n// Possible states\nconst WITHDRAWALSTATES = {\n  UnknownError: -2,\n  Nothing: -1,\n  CorruptedToken: 0,\n  RingNotClosed: 1,\n  RingNotEnoughParticipantsToClose: 2,\n  ForceClosingRing: 3,\n  FailedCloseRing: 4,\n  SuccessCloseRing: 5,\n  InvalidRing: 6,\n  InvalidSignature: 7,\n  SignatureUsed: 8,\n  Withdrawn: 9\n}\n\nconst WithdrawPage = (props: { dappGateway: DappGateway }) => {\n  const { dappGateway } = props\n\n  const [ringParticipants, setRingParticipants] = useState({\n    deposited: 0,\n    withdrawn: 0\n  })\n  const [unknownErrorStr, setUnknownErrorStr] = useState('')\n  const [txReceipt, setTxReceipt] = useState(null)\n  const [forceCloseBlocksLeft, setForceCloseBlocksLeft] = useState(-1)\n  const [heiToken, setHeiToken] = useState('')\n  const [useRelayer, setUseRelayer] = useState(false)\n  const [openModal, setOpenModal] = useState(false)\n  const [withdrawalState, setWithdrawalState] = useState(WITHDRAWALSTATES.Nothing)\n\n  const { noWeb3, noContractInstance } = props\n\n  const getModalDisplay = (ws) => {\n    if (ws === WITHDRAWALSTATES.Nothing || ws === WITHDRAWALSTATES.ForceClosingRing) {\n      return <div>\n        <Loader style={{ margin: 'auto' }} size='10rem' />\n        <br />\n        <Text style={{ textAlign: 'center' }}>Processing transaction ...</Text>\n      </div>\n    } else if (ws === WITHDRAWALSTATES.CorruptedToken) {\n      return <div>Invalid token.</div>\n    } else if (ws === WITHDRAWALSTATES.SuccessCloseRing) {\n      return <div>Ring closed successfully, you can now withdraw the deposits.</div>\n    } else if (ws === WITHDRAWALSTATES.FailedCloseRing) {\n      return <div>Failed to close ring. Likely an invalid signature or Ring isn't mature enough.</div>\n    } else if (ws === WITHDRAWALSTATES.RingNotClosed) {\n      // User can close it themselves\n      if (forceCloseBlocksLeft === 0) {\n        // Use cannot close it if deposited < 2\n        if (ringParticipants.deposited < 2) {\n          return (\n            <div>\n              Ring isn't closed yet, and there is only participant (you) in the Ring. <br /><br />\n\n              You may close the ring and withdraw the funds when there are at least two participants in the Ring.\n            </div>\n          )\n        }\n\n        return (\n          <div>\n            <Text>\n              Ring isn't closed yet, however you can manually close it.\n              <br /><br />\n              There are {ringParticipants.deposited} participant(s) in the Ring.\n              {\n                ringParticipants.deposited <= 1\n                  ? <div>Your transaction is <strong>not</strong> mixed, and your privacy is <strong>not</strong> guaranteed.</div>\n                  : ringParticipants.deposited <= 3\n                    ? <div>Your transaction is <strong>somewhat</strong> mixed, and your privacy is <strong>somewhat</strong> guaranteed.</div>\n                    : <div>Your transaction is mixed, and your privacy is guaranteed.</div>\n              }\n              <br />\n              Manually close Ring?\n              <Button\n                onClick={() => {\n                  (async () => {\n                    // Reset state\n                    setWithdrawalState(WITHDRAWALSTATES.Nothing)\n\n                    // Invalid heiToken\n                    const { ethAddress, heiswapInstance, web3 } = dappGateway\n\n                    // eslint-disable-next-line no-unused-vars\n                    const [ethAmount, ringIdx, randomSk] = heiToken.split('-').slice(1)\n\n                    // Checks if ring is closed\n                    const ringHash = await heiswapInstance\n                      .methods\n                      .getRingHash(ethAmount, ringIdx)\n                      .call()\n\n                    const ringHashBuf = Buffer.from(\n                      ringHash.slice(2), // Remove the '0x'\n                      'hex'\n                    )\n\n                    // Get Public Keys\n                    const publicKeys: [[String, String]] = await heiswapInstance\n                      .methods\n                      .getPublicKeys(ethAmount, ringIdx)\n                      .call()\n\n                    // Convert to array of Point\n                    const publicKeysBN: [Point] = publicKeys\n                      .map(x => {\n                        return [\n                        // Slice the '0x'\n                          new BN(Buffer.from(x[0].slice(2), 'hex')),\n                          new BN(Buffer.from(x[1].slice(2), 'hex'))\n                        ]\n                      })\n                      .filter(x => x[0].cmp(bnZero) !== 0 && x[1].cmp(bnZero) !== 0)\n\n                    if (publicKeysBN.length < 2) {\n                      setWithdrawalState(WITHDRAWALSTATES.RingNotEnoughParticipantsToClose)\n                      return\n                    }\n\n                    // Check if user is able to generate any one of these public keys\n                    const stealthSk: Scalar = h1(\n                      serialize([randomSk, ethAddress])\n                    )\n                    const stealthPk: Point = bn128.ecMulG(stealthSk)\n\n                    let secretIdx = 0\n                    let canSign = false\n                    for (let i = 0; i < publicKeysBN.length; i++) {\n                      const curPubKey = publicKeysBN[i]\n\n                      if (curPubKey[0].cmp(stealthPk[0]) === 0 && curPubKey[1].cmp(stealthPk[1]) === 0) {\n                        secretIdx = i\n                        canSign = true\n                        break\n                      }\n                    }\n\n                    if (!canSign) {\n                      setWithdrawalState(WITHDRAWALSTATES.InvalidSignature)\n                      return\n                    }\n\n                    // Create signature\n                    const signature = bn128.ringSign(\n                      ringHashBuf,\n                      publicKeysBN,\n                      stealthSk,\n                      secretIdx\n                    )\n\n                    // Construct bytecode\n                    const dataBytecode = heiswapInstance\n                      .methods\n                      .forceCloseRing(\n                        ethAmount,\n                        ringIdx,\n                        append0x(signature[0].toString('hex')),\n                        [\n                          append0x(signature[2][0].toString('hex')),\n                          append0x(signature[2][1].toString('hex'))\n                        ],\n                        signature[1].map(x => append0x(x.toString('hex')))\n                      ).encodeABI()\n\n                    // Just send the dataBytecode to a relayer\n                    // TFW can't signTransaction with web3.eth.signTransaction\n                    // web3 is so broken, the versioning is so fucked,\n                    // the docs are so outdated. Fucking hell.\n                    if (useRelayer) {\n                      try {\n                        // TODO: Post dataBytecode to relayer\n                      } catch (exc) {\n                      }\n                    } else {\n                      // Broadcast the transaction otherwise\n                      try {\n                        const gas = await web3.eth.estimateGas({\n                          to: heiswapInstance._address,\n                          data: dataBytecode\n                        })\n\n                        const tx = {\n                          from: ethAddress,\n                          to: heiswapInstance._address,\n                          gas,\n                          data: dataBytecode,\n                          nonce: await web3.eth.getTransactionCount(ethAddress)\n                        }\n\n                        const txR = await web3.eth.sendTransaction(tx)\n\n                        setTxReceipt(txR)\n                        setWithdrawalState(WITHDRAWALSTATES.SuccessCloseRing)\n                      } catch (exc) {\n                        setWithdrawalState(WITHDRAWALSTATES.FailedCloseRing)\n                      }\n                    }\n                  })()\n                }}\n                width={1}>\n                Close Ring\n              </Button>\n            </Text>\n          </div>\n        )\n      } else {\n        return (\n          <div>\n            <Text>\n              Ring isn't closed yet. <br />\n              You can manually close it in {forceCloseBlocksLeft} number of blocks.\n            </Text>\n          </div>\n        )\n      }\n    } else if (ws === WITHDRAWALSTATES.RingNotEnoughParticipantsToClose) {\n      return (\n        <div>\n          Needs at least one more participant in your Ring before you can close it manually.\n        </div>\n      )\n    } else if (ws === WITHDRAWALSTATES.InvalidRing) {\n      return (\n        <div>\n          Invalid signature.\n        </div>\n      )\n    } else if (ws === WITHDRAWALSTATES.InvalidSignature) {\n      return (\n        <div>\n          No funds deposited for\n          <br />\n          { dappGateway.ethAddress }\n          <br /><br />\n          Try changing your Ethereum account.\n        </div>\n      )\n    } else if (ws === WITHDRAWALSTATES.SignatureUsed) {\n      return (\n        <div>\n          Funds have already been withdrawn.\n        </div>\n      )\n    } else if (ws === WITHDRAWALSTATES.Withdrawn) {\n      return (\n        <div>\n          Withdrawal successful.&nbsp;\n          <a href={`https://ropsten.etherscan.io/tx/${txReceipt.transactionHash}`}>\n            View on etherscan.\n          </a>\n        </div>\n      )\n    }\n\n    return <div>\n      <a href='https://github.com/kendricktan/heiswap-dapp/issues'>\n        Please open a new issue with the error description below.\n      </a>\n      <br />\n      Unknown error occured: <br />{ unknownErrorStr }\n    </div>\n  }\n\n  return (\n    <div style={{ width: '100%' }}>\n      <Form onSubmit={(e) => {\n        (async () => {\n          e.preventDefault()\n\n          const { ethAddress, heiswapInstance, web3 } = dappGateway\n\n          // Opens modal\n          setOpenModal(true)\n\n          // Invalid heiToken\n          if (heiToken.split('-').length - 1 !== 3) {\n            setWithdrawalState(WITHDRAWALSTATES.CorruptedToken)\n            return\n          }\n\n          // eslint-disable-next-line no-unused-vars\n          const [ethAmount, ringIdx, randomSk] = heiToken.split('-').slice(1)\n\n          // Checks if ring is closed\n          const ringHash = await heiswapInstance\n            .methods\n            .getRingHash(ethAmount, ringIdx)\n            .call()\n          const ringHashBuf = Buffer.from(\n            ringHash.slice(2), // Remove the '0x'\n            'hex'\n          )\n          const ethAddressBuf = Buffer.from(\n            ethAddress.slice(2), // Remove the '0x'\n            'hex'\n          )\n          const msgBuf = Buffer.concat([\n            ringHashBuf,\n            ethAddressBuf\n          ])\n\n          // If ring hash isn't closed\n          // 32 bytes (64 chars + 2 chars ('0x')))\n          if (ringHash.length !== 66) {\n            const blocksLeftStr = await heiswapInstance\n              .methods\n              .getForceCloseBlocksLeft(ethAmount, ringIdx)\n              .call()\n\n            const blocksLeft = parseInt(blocksLeftStr)\n\n            // If blocksLeft === 0\n            // User can close the ring, display information\n            // regarding their privacy before they close it manually\n            if (blocksLeft === 0) {\n              const curParticipants = await heiswapInstance\n                .methods\n                .getParticipants(ethAmount, ringIdx)\n                .call()\n\n              setRingParticipants({\n                deposited: curParticipants[0],\n                withdrawn: curParticipants[1]\n              })\n            }\n\n            setForceCloseBlocksLeft(blocksLeft)\n            setWithdrawalState(WITHDRAWALSTATES.RingNotClosed)\n            return\n          }\n\n          // Get Public Keys\n          // Don't want uninitialized keys\n          // Since solidity can't return dynamic arrays\n          const publicKeys: [[String, String]] = await heiswapInstance\n            .methods\n            .getPublicKeys(ethAmount, ringIdx)\n            .call()\n\n          // Convert to array of Point\n          const publicKeysBN: [Point] = publicKeys\n            .map(x => {\n              return [\n                // Slice the '0x'\n                new BN(Buffer.from(x[0].slice(2), 'hex')),\n                new BN(Buffer.from(x[1].slice(2), 'hex'))\n              ]\n            })\n            .filter(x => x[0].cmp(bnZero) !== 0 && x[1].cmp(bnZero) !== 0)\n\n          // Check if user is able to generate any one of these public keys\n          const stealthSk: Scalar = h1(\n            serialize([randomSk, ethAddress])\n          )\n          const stealthPk: Point = bn128.ecMulG(stealthSk)\n\n          let secretIdx = 0\n          let canSign = false\n          for (let i = 0; i < publicKeysBN.length; i++) {\n            const curPubKey = publicKeysBN[i]\n\n            if (curPubKey[0].cmp(stealthPk[0]) === 0 && curPubKey[1].cmp(stealthPk[1]) === 0) {\n              secretIdx = i\n              canSign = true\n              break\n            }\n          }\n\n          if (!canSign) {\n            setWithdrawalState(WITHDRAWALSTATES.InvalidSignature)\n            return\n          }\n\n          // Create signature\n          const signature = bn128.ringSign(\n            msgBuf,\n            publicKeysBN,\n            stealthSk,\n            secretIdx\n          )\n\n          // Create the transaction\n          const dataBytecode = heiswapInstance\n            .methods\n            .withdraw(\n              ethAddress,\n              ethAmount,\n              ringIdx,\n              append0x(signature[0].toString('hex')),\n              [\n                append0x(signature[2][0].toString('hex')),\n                append0x(signature[2][1].toString('hex'))\n              ],\n              signature[1].map(x => append0x(x.toString('hex')))\n            ).encodeABI()\n\n          // Just send the dataBytecode to a relayer\n          // TFW can't signTransaction with web3.eth.signTransaction\n          // web3 is so broken, the versioning is so fucked,\n          // the docs are so outdated. Fucking hell.\n          if (useRelayer) {\n            try {\n              // TODO: Post dataBytecode to relayer\n            } catch (exc) {\n            }\n          } else {\n            // Broadcast the transaction otherwise\n            try {\n              const gas = await web3.eth.estimateGas({\n                to: heiswapInstance._address,\n                data: dataBytecode\n              })\n\n              const tx = {\n                from: ethAddress,\n                to: heiswapInstance._address,\n                gas,\n                data: dataBytecode,\n                nonce: await web3.eth.getTransactionCount(ethAddress)\n              }\n\n              const txR = await web3.eth.sendTransaction(tx)\n\n              setTxReceipt(txR)\n              setWithdrawalState(WITHDRAWALSTATES.Withdrawn)\n            } catch (exc) {\n              const excStr = exc.toString()\n\n              if (excStr.indexOf('Signature has been used!') !== 0) {\n                setWithdrawalState(WITHDRAWALSTATES.SignatureUsed)\n              } else if (excStr.indexOf('Invalid signature') !== 0) {\n                setWithdrawalState(WITHDRAWALSTATES.InvalidSignature)\n              } else if (excStr.indexOf('Ring isn\\'t closed') !== 0) {\n                setWithdrawalState(WITHDRAWALSTATES.RingNotClosed)\n              } else if (excStr.indexOf('All funds from current Ring') !== 0) {\n                setWithdrawalState(WITHDRAWALSTATES.SignatureUsed)\n              } else {\n                setUnknownErrorStr(excStr)\n                setWithdrawalState(WITHDRAWALSTATES.UnknownError)\n              }\n            }\n          }\n        })()\n      }} width='100%'>\n        <Form.Field label='Token' width={1}>\n          <Form.Input\n            type='text'\n            placeholder='hei-xxxxxxxx'\n            required\n            width={1}\n            value={heiToken}\n            onChange={(e) => setHeiToken(e.target.value)}\n          />\n        </Form.Field>\n        {/* <Box>\n          <Form.Check\n            checked={useRelayer}\n            label={<span>Retrieve via relayer. <a href='/faq'>More Info</a></span>}\n            mb={3}\n            onChange={(e) => setUseRelayer(e.target.checked)}\n          />\n        </Box> */}\n        <Button type='submit' width={1} disabled={noWeb3 || noContractInstance}>\n            Withdraw\n        </Button>\n      </Form>\n\n      <Modal isOpen={openModal}>\n        <Card style={{ maxWidth: '620px' }} p={0}>\n          <Button.Text\n            icononly\n            icon={'Close'}\n            color={'moon-gray'}\n            position={'absolute'}\n            top={0}\n            right={0}\n            mt={3}\n            mr={3}\n            onClick={() => {\n              setOpenModal(false)\n              setWithdrawalState(WITHDRAWALSTATES.Nothing)\n            }}\n          />\n\n          <Box p={4} mb={3}>\n            { getModalDisplay(withdrawalState) }\n          </Box>\n        </Card>\n      </Modal>\n    </div>\n  )\n}\n\nexport default WithdrawPage\n","// @flow\n\n/*\n * alt_bn_128 curve in JavaScript\n * Referenced https://github.com/AztecProtocol/aztec-crypto-js/blob/master/bn128/bn128.js\n */\n\nconst EC = require('elliptic')\nconst crypto = require('crypto')\nconst BN = require('bn.js')\nconst { soliditySha3, padLeft } = require('web3-utils')\n\n// Types\n// Since JS doesn't handle BigInteger well,\n// the scalar representation will be the a BN object\nexport type Scalar = BN;\nexport type Point = [Scalar, Scalar];\nexport type Signature = [Scalar, Array<Scalar>, Point];\n\n// AltBn128 field properties\nconst P: Scalar = new BN(\n  '21888242871839275222246405745257275088696311157297823662689037894645226208583',\n  10\n)\nconst N = new BN(\n  '21888242871839275222246405745257275088548364400416034343698204186575808495617',\n  10\n)\nconst A = new BN(\n  '5472060717959818805561601436314318772174077789324455915672259473661306552146',\n  10\n)\nconst G = [new BN(1, 10), new BN(2, 10)]\n\n// Convinience Numbers\nconst bnOne = new BN('1', 10)\nconst bnTwo = new BN('2', 10)\nconst bnThree = new BN('3', 10)\n\n// AltBn128 Object\nconst bn128 = {}\n\n// ECC Curve\nbn128.curve = new EC.curve.short({\n  a: '0',\n  b: '3',\n  p: P,\n  n: N,\n  gRed: false,\n  g: G\n})\n\n/**\n *  BN.js reduction context for bn128 curve group's prime modulus.\n */\nbn128.groupReduction = BN.red(bn128.curve.n)\n\n/**\n * Gets a random Scalar.\n */\nbn128.randomScalar = (): Scalar => {\n  return new BN(crypto.randomBytes(32), 16).toRed(bn128.groupReduction)\n}\n\n/**\n * Gets a random Point on curve.\n */\nbn128.randomPoint = (): Point => {\n  const recurse = () => {\n    const x = new BN(crypto.randomBytes(32), 16).toRed(bn128.curve.red)\n    const y2 = x\n      .redSqr()\n      .redMul(x)\n      .redIAdd(bn128.curve.b)\n    const y = y2.redSqrt()\n    if (\n      y\n        .redSqr(y)\n        .redSub(y2)\n        .cmp(bn128.curve.a)\n    ) {\n      return recurse()\n    }\n    return [x, y]\n  }\n  return recurse()\n}\n\n/**\n *  Returns (beta, y) given x\n *\n *  Beta is used to calculate if the Point exists on the curve\n */\nbn128.evalCurve = (x: Scalar): [Scalar, Scalar] => {\n  const beta = x\n    .mul(x)\n    .mod(P)\n    .mul(x)\n    .mod(P)\n    .add(bnThree)\n    .mod(P)\n  const y = powmod(beta, A, P)\n\n  return [beta, y]\n}\n\n/**\n *  Calculates a Point given a Scalar\n */\nbn128.scalarToPoint = (_x: Scalar): Point => {\n  let x = _x.mod(N)\n\n  let beta, y, yP\n\n  while (true) {\n    [beta, y] = bn128.evalCurve(x)\n    yP = y.mul(y).mod(P)\n\n    if (beta.cmp(yP) === 0) {\n      return [x, y]\n    }\n    x = x.add(bnOne).mod(N)\n  }\n}\n\n/**\n *  ECC addition operation\n */\nbn128.ecAdd = (point1: Point, point2: Point): Point => {\n  const p1 = bn128.curve.point(point1[0], point1[1])\n  const p2 = bn128.curve.point(point2[0], point2[1])\n  const fp = p1.add(p2)\n\n  return [fp.getX(), fp.getY()]\n}\n\n/**\n * ECC multiplication operation\n */\nbn128.ecMul = (p: Point, s: Scalar): Point => {\n  const fp = bn128.curve.point(p[0], p[1]).mul(s)\n\n  return [fp.getX(), fp.getY()]\n}\n\n/**\n * ECC multiplication operation for G\n */\nbn128.ecMulG = (s: Scalar): Point => {\n  return bn128.ecMul(G, s)\n}\n\n/**\n * Ring signature generation\n */\nbn128.ringSign = (\n  message: String,\n  publicKeys: Array<Point>,\n  secretKey: Scalar,\n  secretKeyIdx: int\n): Signature => {\n  const keyCount: int = publicKeys.length\n\n  let c: Array<Scalar> = Array(keyCount).fill(new BN(0, 10))\n  let s: Array<Scalar> = Array(keyCount).fill(new BN(0, 10))\n\n  // Step 1\n  let h: Point = h2(serialize(publicKeys))\n  let yTilde = bn128.ecMul(h, secretKey)\n\n  // Step 2\n  let u = bn128.randomScalar()\n  c[(secretKeyIdx + 1) % keyCount] = h1(\n    serialize([\n      publicKeys,\n      yTilde,\n      message,\n      bn128.ecMul(G, u),\n      bn128.ecMul(h, u)\n    ])\n  )\n\n  // Step 3\n  const indexes = Array(keyCount)\n    .fill(0)\n    .map((x, idx) => idx)\n    .slice(secretKeyIdx + 1, keyCount)\n    .concat(\n      Array(secretKeyIdx)\n        .fill(0)\n        .map((_x, _idx) => _idx)\n    )\n\n  let z1, z2\n\n  indexes.forEach(i => {\n    s[i] = bn128.randomScalar()\n\n    z1 = bn128.ecAdd(bn128.ecMul(G, s[i]), bn128.ecMul(publicKeys[i], c[i]))\n    z2 = bn128.ecAdd(bn128.ecMul(h, s[i]), bn128.ecMul(yTilde, c[i]))\n\n    c[(i + 1) % keyCount] = h1(\n      serialize([publicKeys, yTilde, message, z1, z2])\n    )\n  })\n\n  // Step 4\n  const sci = secretKey.mul(c[secretKeyIdx]).mod(N)\n\n  s[secretKeyIdx] = u.sub(sci)\n\n  // JavaScript negative modulo bug -_-\n  if (s[secretKeyIdx] < 0) {\n    s[secretKeyIdx] = s[secretKeyIdx].add(N)\n  }\n\n  s[secretKeyIdx] = s[secretKeyIdx].mod(N)\n\n  return [c[0], s, yTilde]\n}\n\n/**\n *  Ring signature verification\n */\nbn128.ringVerify = (\n  message: String,\n  publicKeys: Array<Point>,\n  signature: Signature\n): Boolean => {\n  const keyCount = publicKeys.length\n\n  const [c0, s, yTilde] = signature\n  let c = c0.clone()\n\n  // Step 1\n  const h = h2(serialize(publicKeys))\n\n  let z1, z2\n\n  for (let i = 0; i < keyCount; i++) {\n    z1 = bn128.ecAdd(bn128.ecMul(G, s[i]), bn128.ecMul(publicKeys[i], c))\n    z2 = bn128.ecAdd(bn128.ecMul(h, s[i]), bn128.ecMul(yTilde, c))\n\n    if (i < keyCount - 1) {\n      c = h1(serialize([publicKeys, yTilde, message, z1, z2]))\n    }\n  }\n\n  return c0.cmp(h1(serialize([publicKeys, yTilde, message, z1, z2]))) === 0\n}\n\n/* Helper Functions */\n\n/**\n *  Efficient powmod implementation.\n *\n *  Reference: https://gist.github.com/HarryR/a6d56a97ba7f1a4ebc43a40ca0f34044#file-longsigh-py-L26\n *  Returns (a^b) % n\n */\nconst powmod = (a: Scalar, b: Scalar, n: Scalar): Scalar => {\n  let c = new BN('0', 10)\n  let f = new BN('1', 10)\n  let k = new BN(parseInt(Math.log(b) / Math.log(2)), 10)\n\n  let shiftedK\n\n  while (k >= 0) {\n    c = c.mul(bnTwo)\n    f = f.mul(f).mod(n)\n\n    shiftedK = new BN('1' + '0'.repeat(k), 2)\n\n    if (b.and(shiftedK) > 0) {\n      c = c.add(bnOne)\n      f = f.mul(a).mod(n)\n    }\n\n    k = k.sub(bnOne)\n  }\n\n  return f\n}\n\n/**\n * Returns a Scalar repreesntation of the hash of the input.\n */\nconst h1 = (s: String): Scalar => {\n  // Want to be compatible with the solidity implementation\n  // which prepends \"0x\" by default\n  if (s.indexOf('0x') !== 0) {\n    s = '0x' + s\n  }\n\n  const h = soliditySha3(s).slice(2) // Remove the \"0x\"\n  const b = new BN(h, 16)\n\n  return b.mod(N)\n}\n\n/**\n * Returns ECC Point of the Scalar representation of the hash\n * of the input.\n */\nconst h2 = (hexStr: String): Point => {\n  // Note: hexStr should be a string in hexadecimal format!\n  return bn128.scalarToPoint(h1(hexStr))\n}\n\n/**\n * Serializes the inputs into a hex string\n */\nconst serialize = (arr: Array<any>): String => {\n  if (!Array.isArray(arr)) {\n    // eslint-disable-next-line no-throw-literal\n    throw 'arr should be of type array'\n  }\n\n  return arr.reduce((acc, x) => {\n    if (typeof x === 'string') {\n      acc = acc + Buffer.from(x).toString('hex')\n    } else if (Array.isArray(x)) {\n      acc = acc + serialize(x)\n    } else if (Buffer.isBuffer(x)) {\n      acc = acc + x.toString('hex')\n    } else if (x.getX !== undefined && x.getY !== undefined) {\n      // Point\n      acc = acc + padLeft(x.getX().toString(16), 64, '0')\n      acc = acc + padLeft(x.getY().toString(16), 64, '0')\n    } else if (x.toString !== undefined) {\n      acc = acc + padLeft(x.toString(16), 64, '0')\n    }\n\n    return acc\n  }, '')\n}\n\n// For testing purposes\n// let secretNum = 4;\n// let message = \"ETH for you and everyone!\";\n// let secretKeys = Array(secretNum).fill(0).map(() => bn128.randomScalar());\n// let publicKeys = secretKeys.map(x => bn128.ecMul(G, x));\n// let signIdx = 1;\n// let signKey = secretKeys[signIdx];\n// let signature = bn128.ringSign(message, publicKeys, signKey, signIdx);\n// console.log(\"Signature verification: \", bn128.verify(message, publicKeys, signature))\n\n// // Print out for easier verification\n// // Pass the params to the python \"verify\" function and it should return True\n// console.log(\"--public keys--\");\n// console.log(\"[\");\n// publicKeys.map(x => {\n//   console.log(\"[\" + x[0].toString(10) + \", \" + x[1].toString(10) + \"],\");\n// });\n// console.log(\"]\");\n// console.log(\"--signature--\");\n// console.log(\"[\" + signature[0].toString(10) + \", [\");\n// signature[1].map(x => {\n//   console.log(x + \",\");\n// });\n// console.log(\"],[\");\n// console.log(signature[2][0].toString(10) + \", \" + signature[2][1].toString(10));\n// console.log(\"]]\");\n\nexport {\n  bn128,\n  powmod,\n  h1,\n  h2,\n  serialize\n}\n","// @flow\n\n// Appends 0x in front of hex strings so\n// it fits the solidity format\nconst append0x = (s: String): String => {\n  if (s.indexOf('0x') !== 0) {\n    return '0x' + s\n  }\n  return s\n}\n\nexport {\n  append0x\n}\n","// @flow\nimport React from 'react'\nimport {\n  Flex,\n  Box,\n  Button,\n  Modal,\n  Card\n} from 'rimble-ui'\n\ntype ModalProps = {\n  isOpen: Boolean,\n  setIsOpen: Function<Boolean>,\n  children: any\n}\n\nconst StatusModal = (props: ModalProps) => {\n  const { isOpen, setIsOpen } = props\n\n  return (\n    <Modal isOpen={isOpen}>\n      <Card style={{ maxWidth: '620px' }} p={0}>\n        <Button.Text\n          icononly\n          icon={'Close'}\n          color={'moon-gray'}\n          position={'absolute'}\n          top={0}\n          right={0}\n          mt={3}\n          mr={3}\n          onClick={() => setIsOpen(false)}\n        />\n\n        <Box p={4} mb={3}>\n          { props.children }\n        </Box>\n\n        <Flex\n          px={4}\n          py={3}\n          borderTop={1}\n          borderColor={'#E8E8E8'}\n          justifyContent={'flex-end'}\n        >\n          <Button.Outline onClick={() => setIsOpen(false)}>\n            Close\n          </Button.Outline>\n        </Flex>\n      </Card>\n    </Modal>\n  )\n}\n\nexport default StatusModal\n","import React from 'react'\nimport { Flex, Box, Heading, Text } from 'rimble-ui'\n\nconst NotFoundPage = () => {\n  return (\n    <Flex px={4} py={4}>\n      <Box m={'auto'} width={[1, 1 / 2]}>\n        <h1>Heiswap</h1>\n        <Heading>404 Not Found</Heading>\n        <Text><a href='/'>Go home.</a></Text>\n      </Box>\n    </Flex>\n  )\n}\n\nexport default NotFoundPage\n","import React from 'react'\nimport { Flex, Box, Text } from 'rimble-ui'\n\nconst FAQPage = () => {\n  return (\n    <Flex px={4} py={4}>\n      <Box m={'auto'} width={[1, 1 / 2]}>\n        <h1>Heiswap FAQ</h1>\n\n        <h3>What is Heiswap?</h3>\n        <Text>\n          Heiswap ( swap) is an Ethereum mixer / tumbler designed to \"mix\" up Ethereum\n          transactions to make them harder to trace back to the original source. Heiswap is built on top of\n          proven technologies like <a href='https://cryptonote.org'>cryptonote</a> used\n          in monero. However, the <a href='https://github.com/kendricktan/heiswap-dapp/tree/master/contracts'>smart contracts</a> used\n          in Heiswap is not yet audited, so use it at your own risk!\n          <br /><br />\n          You may find the source code for the project <a href='https://github.com/kendricktan/heiswap-dapp'>here</a>.\n        </Text>\n\n        <h3>How does it work?</h3>\n        <Text>\n          Imagine you have 5 people from group A, who all want to send $2 to 5 people in group B.\n          To avoid knowing who in particular from group A is sending money to that particular person in group B,\n          we can ask the 5 people from group A to all put their money into a pot, and ask the 5 people from\n          group B to each come and get $2 from the pot.\n          <br /><br />\n          We only learn that group A is sending money to group B,\n          not who is sending money to who, which gives a 1/5 chance (in this scenario) of guessing who the right sender it.\n          Do it one more time and you have a 1/25 of guessing who the sender was. With each \"mix\", the probability of\n          guessing who the sender and receiver are decreases dramatically. That is how Heiswap is able to keep the senders and\n          receivers anonymous, but instead of a pot it uses a smart contract.\n        </Text>\n\n        <br />\n        <hr />\n\n        <h1>Heiswap Guide</h1>\n\n        <h2>Depositing</h2>\n        <Text>\n          Unfortunately due to the nature of <a href='https://cryptonote.org'>cryptonote</a>, participants\n          can only deposit Ethereum in fixed quantities of 2, 4, 8, 16, 32, 64, 128, 256, or 512. To send a \"mixed\"\n          Ethereum transaction, simply click on the \"Deposit\" tab and insert the address that is going to\n          withdraw the deposited Ethereum, select the amount of Ethereum to deposit, and hit deposit.\n\n          <br /><br />\n          <strong>Once the transaction is complete, you'll receive a secret token, and should be sent to / held by the person\n          who is going to withdraw the deposit.</strong>\n\n          <br /><br />\n          <strong>Note</strong>: The destination address is never committed on-chain, and is instead used to calculated a pseudo-stealth address.\n          So even if the token is known to the public, they cannot withdraw the funds unless they know the destination address.\n        </Text>\n\n        <br />\n\n        <h2>Withdrawing</h2>\n        <Text>\n          Before withdrawing, check the status of the deposited Ethereum on the \"Status\" tab with the supplied token\n          to see if the transaction has been sufficiently \"mixed\" before withdrawing.\n\n          <br /><br />\n\n          To withdraw the deposited funds, simply insert the received token into the textbox and click \"withdraw\".\n\n          <br /><br />\n\n          <strong>Relayer:</strong> By default, the transaction is sent to a relayer that will pay the gas needed to execute the transaction.\n          A small fee will be charged for this service (mainly to recover gas costs). If you choose to deselect this option, make sure you have enough gas to cover the transaction.\n        </Text>\n\n        <br />\n\n        <h2>Status</h2>\n        <Text>\n          The status tab tells you if your deposited funds have been sufficiently \"mixed\" to withdraw. Note that if you withdraw\n          your funds before they are sufficiently \"mixed\", then there is a greater chance of tracing the transaction back to the original\n          sender.\n\n          <br /><br />\n\n          To use it, insert the supplied token into the textbox, and make sure you are logged in the approved withdrawal address in MetaMask, and click \"Check Status\".\n        </Text>\n      </Box>\n    </Flex>\n  )\n}\n\nexport default FAQPage\n","// @flow\nimport crypto from 'crypto'\nimport React, { useState } from 'react'\nimport { Loader, Card, Form, Box, Input, Modal, Select, Text, Button, Checkbox } from 'rimble-ui'\nimport { serialize, h1, bn128 } from '../utils/AltBn128'\nimport { DappGateway } from '../types/DappGateway'\n\ntype DepositForumParams = {\n  targetEthAmount: Number,\n  targetEthAddress: String,\n  validEthAddress: Boolean\n}\n\ntype ModalParams = {\n  isOpen: Boolean,\n  heiToken: String,\n  acknowledgeClose: Boolean\n}\n\nconst DepositPage = (props: { dappGateway: DappGateway }) => {\n  const { dappGateway } = props\n\n  // Form validation\n  const [depForumParams: DepositForumParams, setDepForumParams] = useState({\n    targetEthAmount: 2,\n    targetEthAddress: '',\n    validEthAddress: false\n  })\n\n  // Modal to preview progress\n  const [modalParams: ModalParams, setModalParams] = useState({\n    isOpen: false,\n    acknowledgeClose: false,\n    txHash: null, // transaction hash\n    heiTokenEst: null, // Estimate what the hei-token will be\n    heiTokenFinal: null // The real hei-token generated from the contract's ret value firing\n  })\n\n  // Disable buttons etc if web3 isn't injected\n  const { noWeb3, noContractInstance } = props\n\n  return (\n    <div style={{ width: '100%' }}>\n      <Form onSubmit={\n        (e) => {\n          (async () => {\n            // No refresh\n            e.preventDefault()\n\n            const { targetEthAmount, targetEthAddress } = depForumParams\n            const { ethAddress, heiswapInstance, web3 } = dappGateway\n\n            // Generaete a burner secret key\n            // and create a pseudo stealth address\n            const randomSk = crypto.randomBytes(32).toString('hex')\n            const stealthSk = h1(\n              serialize([randomSk, targetEthAddress])\n            )\n\n            // Opens modal\n            const estRingIdx = await heiswapInstance\n              .methods\n              .getCurrentRingIdx(targetEthAmount)\n              .call()\n\n            const heiTokenEst = `hei-${targetEthAmount}-${estRingIdx}-${randomSk}`\n            // Make sure to set heiTokenFinal to null\n            setModalParams(Object.assign({}, modalParams, {\n              isOpen: true,\n              heiTokenEst,\n              heiTokenFinal: null\n            }))\n\n            // Append \"0x\" in front of it, web3 requires it\n            const stealthPk = bn128.ecMulG(stealthSk).map(x => '0x' + x.toString(16))\n\n            // Deposit into Ring\n            try {\n              const gasPrice = await web3.eth.getGasPrice()\n\n              const depositResult = await heiswapInstance\n                .methods\n                .deposit(stealthPk)\n                .send(\n                  {\n                    from: ethAddress,\n                    value: web3.utils.toWei(targetEthAmount.toString(10), 'ether'),\n                    gasLimit: '800000',\n                    gasPrice\n                  }\n                )\n\n              // Get event return value\n              const depositEventRetVal = depositResult.events.Deposited.returnValues\n\n              // Used to get the index of the ring\n              const realRingIdx = depositEventRetVal.idx\n\n              // Generate token\n              // Format is \"hei-<ether-amount>-<idx>-<randomSk>\"\n              const heiTokenFinal = `hei-${targetEthAmount}-${realRingIdx}-${randomSk}`\n\n              setModalParams(Object.assign(modalParams, {\n                isOpen: true,\n                heiTokenFinal,\n                txHash: depositResult.transactionHash\n              }))\n            } catch (exc) {\n              // TODO: Handle Exception\n            }\n          })()\n        }\n      } width='100%'>\n        <Form.Field\n          validated={depForumParams.validEthAddress}\n          label='Approved Withdrawal Address' width={1}\n        >\n          <Form.Input\n            type='text'\n            placeholder='ETH Address: 0x.....'\n            required\n            width={1}\n            value={depForumParams.targetEthAddress}\n            onChange={(e) => {\n              // For the little checkmark\n              if (e.target.value.indexOf('0x') === 0 && e.target.value.length === 42) {\n                e.target.parentNode.classList.add('was-validated')\n              } else {\n                e.target.parentNode.classList.remove('was-validated')\n              }\n\n              setDepForumParams(\n                Object.assign(\n                  {},\n                  depForumParams,\n                  {\n                    targetEthAddress: e.target.value,\n                    validEthAddress: e.target.value.indexOf('0x') === 0 && e.target.value.length === 42\n                  })\n              )\n            }}\n          />\n        </Form.Field>\n        <Form.Field label='ETH Amount' width={1}>\n          <Select\n            items={[\n              '2',\n              '4',\n              '8',\n              '16',\n              '32'\n            ]}\n            required\n            width={1}\n            onChange={(e) => {\n              setDepForumParams(\n                Object.assign(\n                  {},\n                  depForumParams,\n                  { targetEthAmount: e.target.value })\n              )\n            }}\n          />\n        </Form.Field>\n        <Button type='submit' width={1} disabled={noWeb3 || noContractInstance || !depForumParams.validEthAddress}>\n          Deposit\n        </Button>\n      </Form>\n\n      <Modal isOpen={modalParams.isOpen}>\n        <Card style={{ maxWidth: '620px' }} p={0}>\n          {\n            modalParams.acknowledgeClose\n              ? <Button.Text\n                icononly\n                icon={'Close'}\n                color={'moon-gray'}\n                position={'absolute'}\n                top={0}\n                right={0}\n                mt={3}\n                mr={3}\n                onClick={() => {\n                  // Only allow close if tx is complete\n                  // and user acknowledged close\n                  if (modalParams.heiToken !== null && modalParams.acknowledgeClose) {\n                    setModalParams(Object.assign({}, modalParams, { isOpen: false }))\n                  }\n                }}\n              /> : null\n          }\n\n          <Box p={4} mb={3}>\n            <div>\n              {\n                modalParams.heiTokenFinal === null\n                  ? <Loader style={{ margin: 'auto' }} size='10rem' />\n                  : null\n              }\n\n              <br />\n              <Text style={{ textAlign: 'center' }}>\n                {\n                  modalParams.heiTokenFinal === null\n                    ? 'Processing transaction...'\n                    : <a href={`https://ropsten.etherscan.io/tx/${modalParams.txHash}`}>Transaction completed</a>\n                }<br /><br />\n                Ensure the withdrawing party has the following hei-token. <br />\n                <strong>Losing it will make you lose access to the deposited funds.</strong>\n              </Text>\n              <br />\n              <Box>\n                <Checkbox\n                  label='I have saved the hei-token somewhere safe'\n                  mb={3}\n                  onChange={(e) => { setModalParams(Object.assign({}, modalParams, { acknowledgeClose: e.target.checked })) }}\n                />\n              </Box>\n              <Input style={{ textAlign: 'center' }} width='100%' value={\n                modalParams.heiTokenFinal === null ? modalParams.heiTokenEst : modalParams.heiTokenFinal\n              } onChange={() => {}}\n              />\n            </div>\n          </Box>\n\n        </Card>\n      </Modal>\n    </div>\n  )\n}\n\nexport default DepositPage\n","// @flow\nimport React, { useState } from 'react'\nimport { Form, Button, Modal, Card, Box, Loader, Text, Pill } from 'rimble-ui'\nimport { DappGateway } from '../types/DappGateway'\n\ntype StatusPageModalParams = {\n  isOpen: Boolean,\n  invalidToken: Boolean,\n  ringHash: String,\n  maxParticipants: Number,\n  depositedParticipants: Number,\n  withdrawnParticipants: Number,\n  blocksLeftForForceClose: Number\n}\n\nconst StatusPage = (props: { dappGateway: DappGateway }) => {\n  const { dappGateway } = props\n\n  const [heiToken, setHeiToken] = useState('')\n\n  const [modalParams: StatusPageModalParams, setModalParams] = useState({\n    isOpen: false,\n    invalidToken: false,\n    ringHash: null,\n    maxParticipants: null,\n    depositedParticipants: null,\n    withdrawnParticipants: null\n  })\n\n  // Disable buttons etc if web3 isn't injected\n  const { noWeb3, noContractInstance } = props\n\n  return (\n    <div style={{ width: '100%' }}>\n      <Form onSubmit={(e) => {\n        (async () => {\n          e.preventDefault()\n\n          // Invalid heiToken\n          if (heiToken.split('-').length - 1 !== 3) {\n            setModalParams(Object.assign({}, modalParams, { isOpen: true, invalidToken: true }))\n            return\n          }\n\n          // Opens modal to display spinny progress bar\n          setModalParams(Object.assign({}, modalParams, {\n            isOpen: true,\n            invalidToken: false,\n            maxParticipants: null,\n            depositedParticipants: null,\n            withdrawnParticipants: null,\n            blocksLeftForForceClose: null\n          }))\n\n          const { heiswapInstance } = dappGateway\n\n          // eslint-disable-next-line no-unused-vars\n          const [ethAmount, ringIdx, randomSk] = heiToken.split('-').slice(1)\n\n          // Deposited Participants, Withdrawn Participants\n          const participants: [Number, Number] = await heiswapInstance\n            .methods\n            .getParticipants(ethAmount, ringIdx)\n            .call()\n\n          const maxParticipants: Number = await heiswapInstance\n            .methods\n            .getRingMaxParticipants()\n            .call()\n\n          const blocksLeftForForceClose: Number = await heiswapInstance\n            .methods\n            .getForceCloseBlocksLeft(ethAmount, ringIdx)\n            .call()\n          \n          const ringHash = await heiswapInstance\n            .methods\n            .getRingHash(ethAmount, ringIdx)\n            .call()\n\n          // Yay display modal status\n          setModalParams(Object.assign({}, modalParams, {\n            isOpen: true,\n            invalidToken: false,\n            ringHash,\n            maxParticipants: parseInt(maxParticipants),\n            depositedParticipants: parseInt(participants[0]),\n            withdrawnParticipants: parseInt(participants[1]),\n            blocksLeftForForceClose: parseInt(blocksLeftForForceClose)\n          }))\n        })()\n      }} width='100%'>\n        <Form.Field label='Token' width={1}>\n          <Form.Input\n            type='text'\n            placeholder='hei-xxxxxxxx'\n            required\n            width={1}\n            value={heiToken}\n            onChange={(e) => setHeiToken(e.target.value)}\n          />\n        </Form.Field>\n        <Button type='submit'width={1} disabled={noWeb3 || noContractInstance}>\n        Check Ring Status\n        </Button>\n      </Form>\n      <Modal isOpen={modalParams.isOpen}>\n        <Card style={{ maxWidth: '620px' }} p={0}>\n          <Button.Text\n            icononly\n            icon={'Close'}\n            color={'moon-gray'}\n            position={'absolute'}\n            top={0}\n            right={0}\n            mt={3}\n            mr={3}\n            onClick={() => {\n              setModalParams(Object.assign({}, modalParams, { isOpen: false }))\n            }}\n          />\n\n          <Box p={4} mb={3}>\n            <div>\n              {\n                modalParams.invalidToken\n                  ? <Text>Invalid hei-token</Text>\n                  : modalParams.withdrawnParticipants === null\n                    ? <Loader style={{ margin: 'auto' }} size='10rem' />\n                    : <div>\n                      <Text>\n                        <strong>Ring status: </strong>{\n                          modalParams.depositedParticipants >= modalParams.maxParticipants || modalParams.ringHash.length === 66\n                            ? 'Closed'\n                            : modalParams.blocksLeftForForceClose > 0\n                              ? `On-going (${modalParams.blocksLeftForForceClose} blocks till manual intervention allowed)`\n                              : `On-going ${modalParams.depositedParticipants > 1 ? '(Intervention allowed)' : ''}`\n                        }\n                        <br />\n                        <strong>Ring participants: </strong> {`${modalParams.depositedParticipants}/${modalParams.maxParticipants}`}\n                        &nbsp;&nbsp;\n                        {\n                          modalParams.depositedParticipants <= 1\n                            ? <Pill color='red'>Privacy not guaranteed</Pill>\n                            : modalParams.depositedParticipants <= 3\n                              ? <Pill color='primary'>Privacy somewhat guaranteed</Pill>\n                              : <Pill color='green'>Privacy strongly guaranteed</Pill>\n                        }\n                      </Text>\n                    </div>\n              }\n            </div>\n          </Box>\n        </Card>\n      </Modal>\n    </div>\n  )\n}\n\nexport default StatusPage\n","// @flow\n\nimport React, { useState, useEffect } from 'react'\nimport getWeb3 from './utils/getWeb3'\nimport { BrowserRouter as Router, Route, Switch, Link } from 'react-router-dom'\nimport createDrizzleUtils from '@drizzle-utils/core'\nimport Web3StatusModal from './components/Web3StatusModal'\nimport Logo from './assets/key.png'\nimport NotFoundPage from './components/404NotFound'\nimport FAQPage from './components/FAQPage'\nimport DepositPage from './components/DepositPage'\nimport WithdrawPage from './components/WithdrawPage'\nimport StatusPage from './components/StatusPage'\nimport {\n  Heading,\n  Text,\n  Input,\n  Flex,\n  Box,\n  Button,\n  Blockie,\n  QR,\n  Flash,\n  ThemeProvider\n} from 'rimble-ui'\n\nimport { DappGateway } from './types/DappGateway'\nimport heiswapArtifact from './contracts/Heiswap.json'\n\ntype TabState = {\n  index: number\n}\n\nconst HeiSwapApp = () => {\n  // Dapp gateway state\n  const [dappGateway: DappGateway, setDappGateway] = useState({\n    web3: null,\n    drizzleUtils: null,\n    ethAddress: null,\n    attempted: false,\n    heiswapInstance: null,\n    heiswapEvent$: null\n  })\n\n  // Status Modal\n  const [web3StatusModal: Boolean, setweb3StatusModal] = useState(false)\n\n  // \"Tabs\" (made with buttons)\n  const [curTab: TabState, setCurTab] = useState({\n    index: 0\n  })\n\n  // Helper function to initialize web3, drizzleUtils, and the ETH accounts\n  const initDappGateway = async (): Boolean => {\n    // Already initialized\n    if (dappGateway.web3 !== null && dappGateway.drizzleUtils !== null && dappGateway.ethAddress !== null) {\n      return true\n    }\n\n    try {\n      const web3 = await getWeb3()\n      const drizzleUtils = await createDrizzleUtils({ web3 })\n      const accounts = await drizzleUtils.getAccounts()\n\n      let heiswapInstance = null; let heiswapEvent$ = null\n\n      try {\n        heiswapInstance = await drizzleUtils.getContractInstance({ artifact: heiswapArtifact })\n        heiswapEvent$ = await drizzleUtils.createEvent$({ artifact: heiswapArtifact })\n      } catch (err) {\n        heiswapInstance = null\n        heiswapEvent$ = null\n      }\n\n      setDappGateway({\n        web3,\n        drizzleUtils,\n        ethAddress: accounts[0],\n        heiswapInstance,\n        heiswapEvent$,\n        attempted: true\n      })\n\n      // Setup Account Stream\n      drizzleUtils.currentAccount$.subscribe(a => {\n        if (a !== dappGateway.ethAddress) {\n          setDappGateway(Object.assign({}, dappGateway, { ethAddress: a }))\n        }\n      })\n\n      return true\n    } catch (err) {\n      setDappGateway(Object.assign({}, dappGateway, { attempted: true }))\n\n      return false\n    }\n  }\n\n  // On page load, grab web3 and drizzle utils and contract\n  // definitions, as props, and inject them into the browser\n  useEffect(() => {\n    if (\n      (dappGateway.web3 === null || dappGateway.drizzleUtils === null) &&\n      !dappGateway.attempted\n    ) {\n      (async () => {\n        await initDappGateway()\n      })()\n    }\n  })\n\n  // Display warning if no web3 found\n  const noWeb3: boolean = (\n    dappGateway.web3 === null &&\n    dappGateway.drizzleUtils === null &&\n    dappGateway.attempted\n  )\n\n  const noContractInstance: boolean = (\n    dappGateway.heiswapInstance === null &&\n    dappGateway.web3 !== null\n  )\n\n  return (\n    <ThemeProvider>\n      <div style={{ position: 'relative', minHeight: '100vh' }}>\n        <div style={{ paddingBottom: '3.5rem' }}>\n          <Flex>\n            <Box p={3} width={1} style={{ textAlign: 'right' }}>\n              {dappGateway.ethAddress === null ? (\n                <Button size='small' style={{ marginTop: '10px' }}\n                  onClick={() => {\n                    if (dappGateway.ethAddress === null) {\n                      (async () => {\n                        if (!await initDappGateway()) {\n                          setweb3StatusModal(true)\n                        }\n                      })()\n                    }\n                  }}\n                >\n                  Connect\n                </Button>\n              ) : (\n                <Button.Outline size='small' style={{ marginTop: '10px' }}\n                  onClick={() => setweb3StatusModal(true)}\n                >\n                  <Blockie opts={{ seed: dappGateway.ethAddress, size: 4 }} />\n                    &nbsp;&nbsp;\n                  {dappGateway.ethAddress.slice(0, 5) + '...' + dappGateway.ethAddress.slice(-4)}\n                </Button.Outline>\n              )}\n            </Box>\n          </Flex>\n\n          <Flex>\n            <Box m={'auto'} width={[1, 1 / 2]}>\n              <div style={{ margin: '0 20px 0 20px' }}>\n                <Button.Text>\n                  <img alt='logo' src={Logo} style={{ width: '16px', height: '16px', marginRight: '6px' }} />\n                    Heiswap\n                </Button.Text>\n                <div style={{ float: 'right' }}>\n                  <a href='https://kndrck.co/posts/introducing_heiswap/'>\n                    <Button.Text>\n                      Help & FAQ\n                    </Button.Text>\n                  </a>\n                </div>\n              </div>\n              <Flex\n                px={4}\n                py={3}\n                borderTop={1}\n                borderBottom={1}\n                borderColor={'#E8E8E8'}\n                justifyContent={'space-between'}\n              >\n                { curTab.index === 0\n                  ? <Button>Deposit</Button>\n                  : <Button.Outline onClick={() => setCurTab({ index: 0 })}>Deposit</Button.Outline>\n                }\n                { curTab.index === 1\n                  ? <Button>Withdraw</Button>\n                  : <Button.Outline onClick={() => setCurTab({ index: 1 })}>Withdraw</Button.Outline>\n                }\n                { curTab.index === 2\n                  ? <Button>Status</Button>\n                  : <Button.Outline onClick={() => setCurTab({ index: 2 })}>Status</Button.Outline>\n                }\n              </Flex>\n\n              {\n                noWeb3\n                  ? <Flex\n                    px={4}\n                    py={3}\n                    justifyContent={'stretch'}\n                  >\n                    <Flash variant='danger'>\n                      Please connect your Ethereum account to continue\n                    </Flash>\n                  </Flex>\n                  : dappGateway.heiswapInstance === null && dappGateway.web3 !== null\n                    ? <Flex\n                      px={4}\n                      py={3}\n                      justifyContent={'stretch'}\n                    >\n                      <Flash variant='danger'>\n                      Heiswap is currently only on ropsten\n                      </Flash>\n                    </Flex>\n                    : null\n              }\n\n              <Flex\n                px={4}\n                py={3}\n                justifyContent={'stretch'}\n              >\n                {\n                  (curTab.index === 0) ? <DepositPage dappGateway={dappGateway} noWeb3={noWeb3} noContractInstance={noContractInstance}/>\n                    : (curTab.index === 1) ? <WithdrawPage dappGateway={dappGateway} noWeb3={noWeb3} noContractInstance={noContractInstance}/>\n                      : (curTab.index === 2) ? <StatusPage dappGateway={dappGateway} noWeb3={noWeb3} noContractInstance={noContractInstance}/>\n                        : <div>Invalid Page</div>\n                }\n              </Flex>\n            </Box>\n          </Flex>\n\n          <Web3StatusModal isOpen={web3StatusModal} setIsOpen={setweb3StatusModal}>\n            {\n              dappGateway.ethAddress === null\n                ? (\n                  <div>\n                    <Heading.h3>No Ethereum account found</Heading.h3>\n                    <br />\n                    <Text>\n                      Please visit this page in a Web3 enabled browser.{' '}\n                      <a href='https://ethereum.org/use/#_3-what-is-a-wallet-and-which-one-should-i-use'>\n                        Learn more\n                      </a>\n                    </Text>\n                  </div>\n                )\n                : (\n                  <div style={{ textAlign: 'center' }}>\n                    <Heading.h3>Connected Ethereum account</Heading.h3>\n                    <br />\n                    <Text style={{ textAlign: 'center' }}>\n                      <QR value={dappGateway.ethAddress} />\n                      <br /><br />\n                      <Input\n                        style={{ textAlign: 'center' }}\n                        width='100%'\n                        type='text' onChange={() => { }} value={dappGateway.ethAddress}\n                      />\n                    </Text>\n                  </div>\n                )\n            }\n          </Web3StatusModal>\n        </div>\n\n        <div style={{ position: 'absolute', bottom: '0', width: '100%', height: '3.5rem', borderTop: '1px solid #E8E8E8' }}>\n          <Text style={{ textAlign: 'center', paddingTop: '1rem' }}>\n            Built by&nbsp;<a href='https://kndrck.co'>Kendrick Tan</a>&nbsp;|&nbsp;<a href='https://github.com/kendricktan/heiswap-dapp'>Source code</a>\n          </Text>\n        </div>\n      </div>\n    </ThemeProvider>\n  )\n}\n\nconst App = () => {\n  return (\n    <Router>\n      <Switch>\n        <Route exact path='/' component={HeiSwapApp} />\n        <Route exact path='/faq' component={FAQPage} />\n        <Route component={NotFoundPage} />\n      </Switch>\n    </Router>\n  )\n}\n\nexport default App\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './App'\nimport * as serviceWorker from './serviceWorker'\n\nReactDOM.render(<App />, document.getElementById('root'))\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister()\n"],"sourceRoot":""}